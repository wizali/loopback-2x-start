!function(e,i){"use strict";var r=["phoebe.library.chosen","phoebe.library.pagination","phoebe.library.directive"];i.module("phoebe.library",r)}(window,window.angular);
!function(){var e,t="phoebe.library.directive";try{e=angular.module(t)}catch(a){e=angular.module(t,[])}e.directive("phoPopBox",[function(){return{restrict:"A",scope:{cancelfun:"&",clearfun:"&",submitfun:"&",beforeopen:"&",closefun:"&"},template:"<pho ng-transclude></pho>",replace:!1,transclude:!0,link:function(e,t,a){function n(e){var t=80;(e.cancelfun||e.clearfun||e.submitfun)&&(t=120);var a=e.id,n=$(window).height()-t,i=$("#"+a).height(),r={"max-height":n,"overflow-y":"auto","overflow-x":"auto"};i>n&&(r={height:n,"overflow-y":"scroll","overflow-x":"hidden"}),$("#"+a).css(r)}var i=[];a.hasOwnProperty("cancelfun")&&i.push({text:"关闭","class":"btn btn-xs",click:function(){$(this).dialog("destroy").addClass("hide"),e.cancelfun()}}),a.hasOwnProperty("clearfun")&&i.push({text:"清空","class":"btn btn-success btn-xs",click:function(){e.clearfun()}}),a.hasOwnProperty("submitfun")&&i.push({text:"提交","class":"btn btn-primary btn-xs",click:function(){e.submitfun()}}),t.on("click",function(){var t=e.beforeopen();(t||void 0===t)&&($("#"+a.target).removeClass("hide").dialog({modal:!0,title:"<div class='widget-header widget-header-small'><h4 class='smaller'>"+a.title+"</h4></div>",width:a.width||null,title_html:!0,buttons:i}),a.hasOwnProperty("closefun")&&$("#"+a.target).on("dialogclose",function(){e.closefun()}),a.height&&$("#"+a.target).dialog({height:a.height||null}),n(a))})}}}]),e.directive("phoPaginCtrl",[function(){return{restrict:"E",replace:!0,transclude:!0,template:function(e,t){var a=t.model,n='<option value="5">5</option>';for(i=1;5>=i;i++)n+='<option value="'+10*i+'">'+10*i+"</option>";return'<div class="dataTables_length"><label>显示 <select size="1" ng-model="'+a+'" aria-controls="sample-table-2">'+n+"</select> 条数据</label></div>"},link:function(e,t,a){var n=a.model;e[n]="10"}}}]),e.directive("phoWell",[function(){return{restrict:"E",template:function(e,t){var a=t.title||"";return'<div class="widget-box"><div class="widget-header widget-header-small"><h5 class="widget-title lighter">'+a+'</h5><span class="widget-toolbar"><a href="javascript:void(0)" data-role="plus"><i class="ace-icon fa fa-plus"></i></a></span></div><div class="widget-body"><div class="widget-core"><div class="profile-activity clearfix" ng-transclude></div></div></div></div>'},replace:!0,transclude:!0,link:function(e,t){var a='<div class="tools action-buttons"><a href="javascript:void(0)" class="red" data-role="del"><i class="ace-icon fa fa-times bigger-125"></i></a></div>',n=t.find(".widget-core"),i='<div class="profile-activity clearfix">'+n.children().eq(0).html()+a+"</div>";t.find("a[data-role=plus]").on("click",function(){n.append($(i))}),t.delegate("a[data-role=del]","click",function(){window.confirm("确定删除吗？")&&$(this).closest(".profile-activity").remove()})}}}]),e.directive("phoSimpleWell",[function(){return{restrict:"E",replace:!0,transclude:!0,template:function(e,t){var a=t.id;return a||console.log("请给您的phoSimpleWell指令添加“data-id”属性！否则无法添加getValue方法！"),'<pho id=""><div class="well" ng-transclude></div></pho>'},link:function(e,t,a){var n=a.id,i='<a href="javascript:void(0);" class="green"><i class="ace-icon fa fa-plus"></i></a>',r='<a href="javascript:void(0);" class="red"><i class="ace-icon fa fa-times"></i></a>',c='<div class="well">'+t.find("div:first").html()+r+"</div>",l='<div class="well">'+t.find("div:first").html()+i+"</div>";$(i).appendTo(t.find("div:first")),t.delegate("a.green","click",function(){$(c).appendTo(t),angular.forEach(t.children("div:last").find("input[class*=date-picker]"),function(e){$(e).datepicker({autoclose:!0,format:"yyyy-mm-dd"}),$(e).next().on("click",function(){$(this).prev().focus()})})}),t.delegate("a.red","click",function(){window.confirm("确定删除吗？")&&($(this).prev().find("input[type=hidden]").val()?$(this).parent().hide().attr("state","remove"):$(this).parent().remove())}),e.UI=e.UI||{},groupName=n.substr(0,1).toUpperCase()+n.substr(1),e.UI["get"+groupName+"Value"]=function(){var e=[];return angular.forEach(t.children("div[class*=well]"),function(t){var a=$(t);o={},"remove"==a.attr("state")&&(o.state="remove"),angular.forEach(a.find("input"),function(e){var t=$(e).attr("data-key");("id"!==t||"id"===t&&""!==$(e).val())&&(o[t]=$(e).val())}),angular.forEach(a.find("textarea"),function(e){o[$(e).attr("data-key")]=$(e).val()}),angular.forEach(a.find("select"),function(e){o[$(e).attr("data-key")]=$(e).val()}),e.push(o)}),e},e.UI["set"+groupName+"Value"]=function(e){t.html(""),$(l).appendTo(t);for(var a=e.length-1,n=t.find("a.green"),i=0;a>i;i++)n.trigger("click");angular.forEach(e,function(e,a){var n=t.children("div").eq(a);for(var i in e)n.find("[data-key="+i+"]").val(e[i])})}}}}]),e.directive("phoRadio",[function(){return{restrict:"E",replace:!0,scope:{change:"&"},template:function(e,t){var a=t.group,n=t.value,i=e.html();return'<div class="radio"><label><input name="'+a+'" value="'+n+'" type="radio" class="ace"><span class="lbl">'+i+"</span></label></div>"},link:function(e,t,a){"true"==a.selected&&(t.find("input")[0].checked=!0);var n=a.group,i=n.substr(0,1).toUpperCase()+n.substr(1);e.$parent.UI=e.$parent.UI||{},e.$parent.UI["get"+i+"Value"]=function(){var e="";return angular.forEach($("input[name="+n+"]"),function(t){t.checked===!0&&(e=$(t).val())}),e},e.$parent.UI["set"+i+"Value"]=function(e){angular.forEach($("input[name="+n+"]"),function(t){$(t).val()==e&&(t.checked=!0)})},a.change&&t.on("change",function(){e.change(e.$parent.UI["get"+i+"Value"]())})}}}]),e.directive("phoCheckbox",function(){return{restrict:"E",replace:!0,scope:{change:"&"},template:function(e,t){var a=t.group,n=e.html(),i=t.value?'value="'+t.value+'"':"",r=""===t.caption?"caption":"";return'<div class="checkbox pd0 mg0"><label><input name="'+a+'" '+i+' type="checkbox" class="ace" '+r+'><span class="lbl">'+n+"</span></label></div>"},link:function(e,t,a){var n=a.group,i=a.group;""===a.caption&&t.bind("change",function(){var e=$(this).find("input")[0].checked,t=$("input[name="+n+"]");angular.forEach(t,function(t){t.checked=e})}),e.$parent.UI=e.$parent.UI||{},i=i.substr(0,1).toUpperCase()+i.substr(1),e.$parent.UI["get"+i+"Selected"]=function(){var e=[],t=$("input[name="+n+"]");return angular.forEach(t,function(t,a){t.checked&&""!==$(t).attr("caption")&&e.push(a-1)}),e},e.$parent.UI["get"+i+"SelectedValue"]=function(){var e=[],t=$("input[name="+n+"]");return angular.forEach(t,function(t){var a=$(t);t.checked&&""!==a.attr("caption")&&(a.val()?e.push(a.val()):e.push(a.closest("div").attr("data-value")))}),e},e.$parent.UI["set"+i+"Value"]=function(t){e.$parent.UI["clear"+i](),angular.forEach(t,function(e){angular.forEach($("input[value="+e+"]"),function(e){e.checked=!0})})},e.$parent.UI["set"+i+"ValueByIndex"]=function(t){e.$parent.UI["clear"+i](),angular.forEach(t,function(e){$("input[name="+n+"]").eq(e)[0].checked=!0})},e.$parent.UI["clear"+i]=function(){angular.forEach($("input[name="+n+"]"),function(e){e.checked=!1})},e.$parent.UI["select"+i+"All"]=function(){angular.forEach($("input[name="+n+"]"),function(e){e.checked=!0})},a.change&&t.bind("change",function(){var t=($(this).find("input")[0].checked,e.$parent.UI.getCheckboxSelected());e.change(t)})}}}),e.directive("phoSelectAllRows",function(){return function(e,t){t.on("click",function(){var t=this,a=t.checked;$(this).closest("table").find("tr > td:first-child input:checkbox").each(function(){this.checked=a,$(this).closest("tr").toggleClass("selected")}),angular.forEach(e.houses,function(e){e.selected=a})})}}),e.directive("phoWidgetBoxTemplate",function(){var e={restrict:"CEA",link:function(e,t){t.find("a[data-role=widget_close]").on("click",function(){$.hideWidget(angular.element(this).attr("data-target")),e.item={}}),t.find("a[data-role=widget_clear]").on("click",function(){e.item&&(e.item={})})}};return e}),e.directive("phoDatepicker",function(){return function(e,t,a){if($(t).datepicker({autoclose:!0,format:"yyyy-mm-dd"}),$(t).next().on("click",function(){$(this).prev().focus()}),"startDate"===a.role||"endDate"===a.role){var n=null,i=null;"startDate"===a.role?(n=$$(t),i=$$("#"+a.end)):(n=$$("#"+a.start),i=$$(t)),t.on("changeDate",function(){try{var e=n.val().replace(/-/g,""),t=i.val().replace(/-/g,"");e&&t&&e>t&&($.tips("结束日期不能小于起始日期！","error"),$$(this).val(""))}catch(a){console.log(a)}})}"beforeToday"==a.role&&t.on("changeDate",function(){var e=$$(this).val().replace(/-/g,""),t=new Date,a=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i=t.getDate()<10?"0"+t.getDate():t.getDate(),r=a+""+n+i;e>r&&($.tips("所选日期不能大于今天！","error"),$$(this).val(""))})}}),e.directive("phoDataList",[function(){return{restrict:"E",replace:!0,scope:{data:"@list"},transclude:!0,template:function(e,t){var a=t.id;return'<ul class="data-list" id="'+a+'"></ul>'},compile:function(){return{pre:function(e,t){var a=$.parseJSON(e.data),n="";angular.forEach(a,function(e){n+='<li><a href="javascript:void(0)" data-key="'+e.key+'">'+e.value+"</a></li>"}),t.html($(n))},post:function(e,t,a){function n(){var e=[];return angular.forEach(t.find("a.data-list-on"),function(t){e.push($(t).attr("data-key"))}),e}function i(e){var a="";angular.forEach(e,function(e){a+='<li><a href="javascript:void(0)" data-code="'+e.key+'">'+e.value+"</a></li>"}),t.html($(a))}function r(){angular.forEach(t.find("a.data-list-on"),function(e){$(e).removeClass("data-list-on")})}function c(e){var a=null;angular.forEach(t.find("a"),function(t){a=$(t),angular.forEach(e,function(e){a.attr("data-key")==e&&a.addClass("data-list-on")})})}var o=a.id,l=o.substr(0,1).toUpperCase()+o.substr(1);"true"===a.checkbox&&(t.delegate("a","click",function(){$(this).toggleClass("data-list-on")}),e.$parent.UI=e.$parent.UI||{},e.$parent.UI["get"+l+"Value"]=n,e.$parent.UI["set"+l+"Value"]=i,e.$parent.UI["clear"+l+"Value"]=r,e.$parent.UI["set"+l+"Selected"]=c)}}}}}]),e.directive("phoFormControls",["PhoebeResource",function(e){function t(e){var t="";for(var a in e.$attr)switch(a){case"type":break;case"model":t+=' ng-model="'+e[a]+'"';break;case"name":break;case"disabled":e[a]=e[a]||!0,t+=' ng-disabled="'+e[a]+'"';break;case"required":t+=' ng-required="true"';break;case"dict":t+=' ng-options="opt.key as opt.value for opt in '+e[a]+'"';break;case"options":t+=e[a].split(" ").length>1?' ng-options="'+e[a]+'"':' ng-options="opt.id as opt.name for opt in '+e[a]+'"';break;case"style":t+=' style="'+e[a]+'"';break;case"change":t+=' ng-change="'+e[a]+'"';break;case"id":t+=' id="'+e[a]+'"';break;default:t+=" "+e.$attr[a]+'="'+e[a]+'"'}return t}function a(e){var a=e.name?e.name+"：":"",n='<div class="form-element"><label class="form-label">'+a+'</label><div class="form-content">';switch(e.type){case"input":n+='<input class="col-xs-12" type="text"'+t(e)+"/></div></div>";break;case"number":n+='<input class="col-xs-12" type="number"'+t(e)+"/></div></div>";break;case"textarea":n+='<textarea class="col-xs-12"'+t(e)+"></textarea></div></div>";break;case"datepicker":n+='<div class="input-group"><input class="form-control date-picker" type="text" pho_datepicker'+t(e)+'/><span class="input-group-addon"><i class="fa fa-calendar bigger-110"></i></span></div></div></div>';break;case"dropdown":n+='<select class="col-xs-12"'+t(e)+'><option value="">请选择</option></select></div></div>'}return n}return{restrict:"E",template:function(e,t){return a(t)},replace:!0,transclude:!0,link:function(t,a,n){if(n.trigger){var i=n.trigger,r=n.options.split(" ").pop(),c=n.sourceModel,o={},l="query";n.loadCondition&&(o=$.parseJSON(n.loadCondition.replace(/'/g,'"'))),t.$watch(i,function(t,a,n){if(t){var i=new e("/"+c);i[l]("string"==typeof o?{}:o).success(function(e){n[r]=e}).error(function(){$.tips("加载级联下拉框数据失败！","error")})}})}}}}]),e.directive("phoAutoForms",["PhoebeDict","PhoebeResource",function(e,t){function a(e,t){if(!t)return e;for(var a=1,n=e.length;n>a;a++)if(e[a][t]<e[a-1][t]){var i=a-1,r=e[a][t];for(e[a][t]=e[a-1][t];e[i]&&r<e[i][t];)e[i+1][t]=e[i][t],i--;e[i+1][t]=r}return e}function n(e){var t="";return angular.forEach(e,function(e){t+='<div class="col-xs-'+e.grids+'"><div class="form-element"><label class="form-label">'+e.cnName+'：</label><div class="form-content">';var a=e.type;switch(a){case"input":t+='<input type="text" class="form-control '+e.enName+'"></div></div></div>';break;case"datepicker":t+='<div class="input-group"><input class="form-control date-picker '+e.enName+'" /><span class="input-group-addon"><i class="fa fa-calendar bigger-110"></i></span></div></div></div></div>';break;case"textarea":t+='<textarea class="col-xs-12 '+e.enName+'"></textarea></div></div></div>';break;case"dropdown_dict":t+='<select class="form-control '+e.enName+'"><option value="">请选择</option></select></div></div></div>';break;case"dropdown_foreign":t+='<select class="form-control '+e.enName+'"><option value="">请选择</option></select></div></div></div>'}}),t}function i(a,n,i){function c(e,t,a,n){var i="";angular.forEach(t,function(e){i+='<option value="'+e[a]+'">'+e[n]+"</option>"}),e.append($$(i))}var o=angular.copy(i[n])||{};angular.forEach(a,function(a){var n=a.type,l=a.enName,s=$$("."+l);switch(n){case"input":break;case"textarea":break;case"datepicker":s.datepicker({autoclose:!0,format:a.dateFormat||"yyyy-mm-dd"}),s.next().on("click",function(){$(this).prev().focus()});break;case"dropdown_dict":var u=a.dictName;i.dicts&&i.dicts[u]?c(s,i.dicts[u],"key","value"):e.preload([u]).success(function(){i.dicts||(i.dicts={}),i.dicts[u]=e.getDict([u]).dictoptions,c(s,i.dicts[u],"key","value")});break;case"dropdown_foreign":var d=a.foreighModel,p=d+"List";if(p)if(i[d])c(s,i[p],"id","name");else{var f;a.foreignSearchStr&&(f=$.parseJSON(a.foreignSearchStr.replace(/'/g,'"'))),new t("/"+d).query(f||{}).success(function(e){i[p]=e,c(s,i[p],"id","name")}).error("加载外健下拉列表失败！","error")}}o[l]&&r(s,n,o[l])})}function r(e,t,a){if(!a)return!1;switch(t){case"dropdown_dict":break;case"dropdown_foreign":break;default:e.val(a)}}function c(e){var t={};return angular.forEach(e,function(e){var a=e.enName,n=$$("."+a);t[a]=n.val()}),t}function o(e,t,a){if(!a[t])return!1;var n=a[t];angular.forEach(e,function(e){r($$("."+e.enName),e.type,n[e.enName])})}return{restrict:"A",replace:!1,transclude:!1,template:function(){return""},compile:function(){return{pre:function(e,t,r){var c=r.controllers;e.$watch(c,function(e,c,o){var l=r.modelName;if(e&&e.length>0){var s=n(a(e,"index"),l,o);$$(t).html(s),i(e,l,o)}})},post:function(e,t,a){var n=a.id;e["get"+n+"Values"]=c,e["set"+n+"Values"]=o}}}}}]),e.directive("phoFileUpload",[function(){return{restrict:"EA",replace:!0,transclude:!0,template:function(){return window.FileReader||$.tips("您使用的浏览器不支持文件上传功能！","error"),'<label class="ace-file-input"><input type="file"><span class="ace-file-container" data-title="选择文件"><span class="ace-file-name" data-title="单击选择文件"><i class=" ace-icon fa fa-upload"></i></span></span><a class="remove" href="#"><i class=" ace-icon fa fa-times"></i></a></label>'},link:function(e,t,a){function n(e){if(a.maxSize){var t=e.size/1024,n=a.maxSize;if(t>n)return $.tips("所选择的文件大小为【"+t+"M】，超过了最大限制【"+n+"M】，请重新选择！","error"),1}if(a.allow){var i=a.allow,r=e.name.split(".")[1];if(-1==i.indexOf(r))return $.tips("请选择以下格式【"+i+"】","error"),1}return 0}var i=a.id;t.find("input[type=file]").on("change",function(a){e.$apply(function(){t.find(".ace-file-name").attr("data-title","单击选择文件"),e.UI=e.UI||{},e.UI[i+"Value"]={}});var r=($(this),a.target.files[0]),c=new FileReader;c.onloadend=function(a){var n=a.target.result,c=new Date(r.lastModifiedDate),o=c.getFullYear(),l=c.getMonth()+1,s=c.getDate();e.$apply(function(){e.UI[i+"Value"]={size:r.size+"K",name:r.name,updateTime:o+"-"+l+"-"+s,content:n}}),t.find(".ace-file-name").attr("data-title",r.name)},r&&!n(r)&&c.readAsText(r,"UTF-8")}),e.UI=e.UI||{},name=i.substr(0,1).toUpperCase()+i.substr(1),e.UI["get"+name+"Value"]=function(){return e.UI[i+"Value"]},e.UI["clear"+name+"Value"]=function(){t.find("input[type=file]").val(""),t.find(".ace-file-name").attr("data-title","单击选择文件"),e.$apply(function(){e.UI[i+"Value"]={}})}}}}]),e.directive("phoTree",[function(){function e(e,t){return t||$.tips("创建右键菜单失败，因为没有配置项！","error"),this.scope=e,this.config=t,this.treeId=t.id,this.menuId=t.id+"Menu",this.munus=t.menu,this.buildContextMenu(t)}return e.prototype={buildContextMenu:function(e){function t(e){e.push({text:"添加孩子节点"})}function a(e){e.push({text:"编辑节点"})}function n(e){e.push({text:"删除节点"})}var i=this,r=e.id,c=$('<ul id="'+r+'"></ul>'),o=[],l=e.menu.split(" ");if(l.length&&""!==l[0])for(var s=0,u=l.length;u>s;s++){{l[s]}switch(l[s]){case"add":t(o);break;case"edit":a(o);break;case"del":n(o)}}else t(o),a(o),n(o);c.appendTo($("body")).kendoContextMenu({filter:"#"+r+" .k-in",dataSource:o,select:function(e){i.contextMenuHander.call(i,e)}})},contextMenuHander:function(e){var t=this,a=$(e.item),n=$(e.target),i=a.text().substr(0,2),r=$("#"+t.treeId).data("kendoTreeView"),c=r.dataItem(n),o={t:r,n:c};switch(i){case"添加":t.scope.addfun(o);break;case"编辑":t.scope.editfun(o);break;case"删除":t.scope.delfun(o)}}},{restrict:"E",replace:!0,transclude:!1,scope:{addfun:"&",editfun:"&",delfun:"&",selectfun:"&",datasource:"=source"},template:function(){return"<div id></div>"},link:function(t,a,n){var i=t.datasource,r=n.id;t.$watch("datasource",function(t,a,c){if(void 0!==t&&t.length&&t.length>0){i=c.datasource;var o=n.showfield||"name";if(i.length>1){var l=n.idField||"id",s=n.foreignKey||"parentid",u=n.rootlevel||"0";i=$.toKendoTreeData(i,l,s,u)}$("#"+r).kendoTreeView({dataSource:i,loadOnDemand:!1,dataTextField:o});var d=$("#"+r).data("kendoTreeView");if(d.expand(".k-item"),n.selectfun&&d.bind("select",function(e){c.selectfun({t:d,n:d.dataItem(e.node)})}),void 0!==n.menu){new e(c,n)}}})}}}]),e.directive("phoSearch",["PhoebeResource",function(e){return{restrict:"A",scope:{model:"@",showlist:"@",include:"="},link:function(t,a){var n=a.find("input[data-role='keywords']"),i="",r=$("ul[class='dropdown-menu']");r.on("click",function(e){var t=angular.element(e.target),a=t.attr("data-key");angular.element(this).parent().find(".dropdown-toggle").html(t.html()+'<span class="caret">'),i=a});var c=$("button[data-role='searchSubmit']");c.click(function(){var a=n.val(),r={},c=[],o={};return o.field=i,o.val=a,c=t.include,r.like=o,r.include=c,""===i?(console.log("进行模糊查询"),void 0):(new e("/"+t.model).query(r).success(function(e){var a=t.showlist+"DataSource";t.$parent.$model[a]=e}),void 0)})}}}]),e.directive("phoTableSelect",[function(){return function(e,t,a){e[a.tablename]={init:function(){t.find("tr").removeClass("table-mini-tr-selected"),angular.forEach(t.find("input[type=checkbox]"),function(e){e.checked=!1})},getSelected:function(){var e=[],a=t.find("input[type=hidden]");return angular.forEach(a,function(t){var a=$$(t);a.parent().find("input[type=checkbox]")[0].checked&&e.push($$(t).val())}),e}},t.delegate("tbody tr","click",function(e){e.preventDefault();var t=$$(this);t.hasClass("table-mini-tr-selected")?t.removeClass("table-mini-tr-selected").find("input[type=checkbox]")[0].checked=!1:t.addClass("table-mini-tr-selected").find("input[type=checkbox]")[0].checked=!0}),t.delegate("thead input[type=checkbox]","click",function(){var e=this,t=e.checked,a=$$(this).closest("table").find("tbody tr");t?angular.forEach(a,function(e){$$(e).addClass("table-mini-tr-selected").find("input[type=checkbox]")[0].checked=!0}):angular.forEach(a,function(e){$$(e).removeClass("table-mini-tr-selected").find("input[type=checkbox]")[0].checked=!1})})}}]),e.directive("phoSelect",["$parse",function(){return{restrict:"EAC",template:function(){return'<select class="chosen-select"></select>'},scope:{"default":"@",valuefidle:"@",labelfidle:"@",model:"@",options:"=",changed:"&",returnObject:"="},link:function(e,t,a){var n=a.hasOwnProperty("width")?a.width:"60%",i=t.find(".chosen-select");e.$watch("options",function(t){if(t){var a='<option value="" selected>-- '+e.default+" --</option>";angular.forEach(t,function(t){a+='<option value="'+t[e.valuefidle]+'">'+t[e.labelfidle]+"</option>"}),i.append(a),i.chosen().next().css({width:n})}}),i.on("change",function(){if(e.returnObject===!0)for(var t=0;t<e.options.length;t++)e.options[t][e.valuefidle]===i.val()&&(e.$parent[e.model]=e.options[t]);else e.$parent[e.model]=i.val();e.changed&&e.changed(),e.$parent.$apply()})}}}]),e.directive("phoLinkage",function(){return function(e,t,a){var n=e[a.ngModel],i=t.find("select"),r=[];angular.forEach(i,function(e){r.push(angular.element(e).attr("id"))});$.linkage(r,n,"")}}),e.directive("phoPagination",function(){return{restrict:"E",template:'<ul class="pagination"><li class="prev"  ng-class="prevPageDisabled()"><a href="#" ng-click="firstPage()"><i class="fa fa-angle-double-left"></i></a></li><li class="prev"  ng-class="prevPageDisabled()"><a href="#" ng-click="prevPage()"><i class="fa fa-angle-left"></i></a></li><li ng-repeat="n in range()" ng-class="{active: n == pagination.currentPage}" ng-click="setPage(n)"><a href="#">{{n+1}}</a></li><li class="next" ng-class="nextPageDisabled()"><a href="#" ng-click="nextPage()"><i class="fa fa-angle-right"></i></a></li><li class="next" ng-class="nextPageDisabled()"><a href="#" ng-click="lastPage()"><i class="fa fa-angle-double-right"></i></a></li></ul>',replace:!0,link:function(e){e.$watch("items.length",function(e,t,a){a.pagination?a.items&&(a.pagination.items=a.items):(a.items&&a.items.length||(a.items=[]),a.items.length>0&&a.initPagination())}),e.initPagination=function(){e.pagination={itemsPerPage:10,items:e.items,itemCount:e.items.length,currentPage:0,active:0},e.reloadTable=function(){e.pagination.currentPage=0},e.getItemCount=function(){return e.pagination.items.length},e.getPageCount=function(){var t=e.pagination;return Math.ceil(t.items.length/t.itemsPerPage)-1},e.setItemsPerPage=function(t){e.pagination.itemsPerPage=t,e.reloadTable()},e.setPage=function(t){e.pagination.currentPage=t},e.range=function(){for(var t=[],a=e.getPageCount(),n=0;a+1>n;n++)t.push(n);return t},e.firstPage=function(){e.pagination.currentPage=0},e.lastPage=function(){e.pagination.currentPage=e.getPageCount()},e.prevPage=function(){e.pagination.currentPage>0&&e.pagination.currentPage--},e.prevPageDisabled=function(){return 0===e.pagination.currentPage?"disabled":""},e.nextPage=function(){var t=e.pagination;t.currentPage<e.getPageCount()&&e.pagination.currentPage++},e.nextPageDisabled=function(){return e.pagination.currentPage===e.getPageCount()?"disabled":""}}}}}),e.directive("phoImg",[function(){return{restrict:"E",replace:!0,template:'<a href="javascript:void(0);"><input type="file" style="width: 100%;height: 100%;position: absolute;top: 0;opacity: 0"/><img src=""/></a> ',link:function(e,t,a){var n=a.size;t.find("input").attr("ng-disabled",a["ng-disabled"]).on("change",function(e){var a=e.target;if(n){var i=a.files[0].size;if(1e6*parseInt(n,10)<i)return $.tips("上传图片不能超过"+n+"M,请重新选择图片！","error"),!1}var r=new FileReader;r.onload=function(e){t.find("img").attr("src",e.target.result)},r.readAsDataURL(a.files[0])})}}}]),e.directive("phoContainer",["$parse",function(){return{restrict:"EAC",template:"<div></div>",replace:!0,scope:{},link:function(e,t,a){function n(e,t){if(e){var a;return a=e.indexOf("%")>-1?e.substr(0,e.indexOf("%"))/100*t:e.indexOf("px")>-1?e.substr(0,e.indexOf("px")):e}return 0}var i=t.parent(),r={width:i.outerWidth(),height:i.outerHeight()};t.width()||(a.width?t.width(n(a.width,r.width)):t.width(r.width)),a.height?t.height(n(a.height,r.height)):t.height(r.height)}}}]),e.directive("phoFc",["PhoebeResource",function(){function e(e){var t="";for(var a in e.$attr)switch(a){case"type":break;case"name":break;case"id":t+=' id="'+e[a]+'"';break;case"model":t+=' ng-model="'+e[a]+'"';break;case"value":t+=' value="'+e[a]+'"';break;case"required":t+=" required";break;case"disabled":t+=" disabled";break;case"readonly":t+=" readonly";break;case"minlength":t+=' ng-minlength="'+e[a]+'"';break;case"maxlength":t+=' ng-maxlength="'+e[a]+'"';break;case"options":t+=' ng-options="'+e[a]+'"';break;case"style":t+=' style="'+e[a]+'"';break;case"change":t+=' ng-change="'+e[a]+'"';break;case"keydown":t+=' ng-keydown="'+e[a]+'"';break;case"keypress":t+=' ng-keypress="'+e[a]+'"';break;case"keyup":t+=' ng-keyup="'+e[a]+'"';break;case"placeholder":t+=' placeholder="'+e[a]+'"';break;default:t+=" "+e.$attr[a]+'="'+e[a]+'"'}return t+=e.classes?' class="form-control '+e.classes+'"':' class="form-control"'}function t(t){var a=t.type,n=t.cols?t.cols:"12",i=t.name?t.name+"：":"",r='<div class="col-xs-'+n+'"><div class="form-group form-group-sm"><label for="text" class="control-label">'+i+'</label><div class="form-content">',c="";switch(a){case"text":c+='<input type="text" '+e(t)+"/>";break;case"number":c+='<input type="number" '+e(t)+"/>";break;case"url":c+='<input type="url" '+e(t)+"/>";break;case"email":c+='<input type="email" '+e(t)+"/>";break;case"password":c+='<input type="password" '+e(t)+"/>";break;case"textarea":c+='<textarea rows="5" '+e(t)+"></textarea>";break;case"dropdown":c+="<select "+e(t)+'><option value="">请选择</option></select>';break;case"datepicker":c+='<div class="input-group"><input type="text" pho-date'+e(t)+' readonly/><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span></div>'}if(t.th&&"datepicker"!==a){var o=t.th,l="";l="date"===o?'<i class="glyphicon glyphicon-th"></i>':o,r+='<div class="input-group">'+c+'<span class="input-group-addon">'+l+"</span></div></div></div></div>"}else r+=c+"</div></div></div>";return r}return{restrict:"E",template:function(e,a){return t(a)},replace:!0,transclude:!0,link:function(e,t,a){"textarea"===a.type&&$(t).find(".form-group").removeClass("form-group-sm")}}}]),e.directive("phoDate",[function(){return{restrict:"EA",transclude:!1,template:function(e,t){var a=t.$attr;if(a.phoDate)return"";var n="";for(var i in a)switch(i){case"model":n+=' ng-model="'+t[i]+'"';break;case"id":n+=' id="'+t[i]+'"';break;case"required":n+=" required";break;case"disabled":n+=" disabled";break;case"change":n+=' ng-change="'+t[i]+'"';break;case"style":n+=' style="'+t[i]+'"';break;case"placeholder":n+=' placeholder="'+t[i]+'"'}return n+=a.classes?' class="form-control '+t.classes+'"':' class="form-control"','<div class="input-group"><input type="text" '+n+' readonly/><span class="input-group-addon"><i class="glyphicon glyphicon-th"></i></span></div>'},link:function(e,t,a){a.$attr.phoDate||(t=$(t).find("input").eq(0));var n={},i=a.role;if(a.to&&(n.endDate=a.to),a.form&&(n.startDate=a.form),a.format&&a.format.indexOf("hh")>0)n.format=a.format,n.autoclose=!0,$(t).datetimepicker(n);else{if(a.format&&(n.type=a.format),i&&"beforetoday"===i){var r=new Date,c=r.getFullYear(),o=r.getMonth()+1,l=r.getDate(),s=c+"-"+o+"-"+l;n.endDate=s}$(t).cxCalendar(n)}if("start"===i||"end"===i){var u,d;"start"===i?(u=t,d=$("#"+a.end)):(u=$("#"+a.start),d=t),t.on("change",function(){try{var e=new Date(u.val()||0).getTime(),t=new Date(d.val()||0).getTime();e&&t&&e>t&&($.tips("结束日期不能小于起始日期！","error"),$(this).val(""))}catch(a){console.log(a)}})}"beforetoday"==i&&t.on("changeDate",function(){var e=$(this).val().replace(/-/g,""),t=new Date,a=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i=t.getDate()<10?"0"+t.getDate():t.getDate(),r=a+""+n+i;e>r&&($.tips("所选日期不能大于今天！","error"),$(this).val(""))})}}}])}(),$.extend({tips:function(e,t){t=void 0===t?"success":t,t="error"===t?"danger":t,$("#tip_alert").remove();var a="position:fixed;top:150px;left:50%;z-index:9999;border-radius:3px;opacity:0.6;width:230px;margin-left:-100px;text-align:center;",n='<div id="tip_alert" class="alert alert-'+t+'" style="'+a+'">'+e+"</div>";$("body").append($(n));var i=$("#tip_alert");i.animate({opacity:1},200,function(){i.animate({opacity:1},1e3,function(){i.animate({opacity:.2},1500,function(){i.remove()})})})}});

!function(n,o){"use strict";o.module("phoebe.library.chosen",[])}(window,window.angular);
!function(){var e,t="phoebe.library.pagination",n="__default";try{e=angular.module(t)}catch(a){e=angular.module(t,[])}e.directive("dirPaginate",["$compile","$parse","paginationService",function(e,t,a){return{terminal:!0,multiElement:!0,priority:5e3,compile:function(i,r){var s=r.dirPaginate,o=s.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),g=/\|\s*itemsPerPage\s*:[^|]*/;if(null===o[2].match(g))throw"pagination directive: the 'itemsPerPage' filter must be set.";var c=o[2].replace(g,""),u=t(c),l=r.paginationId||n;return a.registerInstance(l),function(i,r,o){var g=t(o.paginationId)(i)||o.paginationId||n;a.registerInstance(g);var c,l=!!s.match(/(\|\s*itemsPerPage\s*:[^|]*:[^|]*)/);c=g===n||l?s:s.replace(/(\|\s*itemsPerPage\s*:[^|]*)/,"$1 : '"+g+"'"),r[0].hasAttribute("dir-paginate-start")||r[0].hasAttribute("data-dir-paginate-start")?(o.$set("ngRepeatStart",c),r.eq(r.length-1).attr("ng-repeat-end",!0)):o.$set("ngRepeat",c);var p,d=e(r,!1,5e3);if(o.currentPage)p=t(o.currentPage);else{var f=g+"__currentPage";i[f]=1,p=t(f)}a.setCurrentPageParser(g,p,i),"undefined"!=typeof o.totalItems?(a.setAsyncModeTrue(g),i.$watch(function(){return t(o.totalItems)(i)},function(e){e>=0&&a.setCollectionLength(g,e)})):i.$watchCollection(function(){return u(i)},function(e){e&&a.setCollectionLength(g,e.length)}),d(i)}}}}]),e.directive("dirPaginationControls",["paginationService","paginationTemplate",function(e){function t(e,t,n,i){var r,s=[],o=Math.ceil(t/n),g=Math.ceil(i/2);r=g>=e?"start":e>o-g?"end":"middle";for(var c=o>i,u=1;o>=u&&i>=u;){var l=a(u,e,i,o),p=2===u&&("middle"===r||"end"===r),d=u===i-1&&("middle"===r||"start"===r);c&&(p||d)?s.push("..."):s.push(l),u++}return s}function a(e,t,n,a){var i=Math.ceil(n/2);return e===n?a:1===e?e:a>n?t>a-i?a-n+e:t>i?t-i+e:e:e}var i=/^\d+$/;return{restrict:"AE",template:function(){var e='<ul class="pagination" ng-if="1 < pages.length"><li ng-if="boundaryLinks" ng-class="{ disabled : pagination.current == 1 }"><a href="" ng-click="setCurrent(1)">&laquo;</a></li><li ng-if="directionLinks" ng-class="{ disabled : pagination.current == 1 }"><a href="" ng-click="setCurrent(pagination.current - 1)">&lsaquo;</a></li><li ng-repeat="pageNumber in pages track by $index" ng-class="{ active : pagination.current == pageNumber, disabled : pageNumber == ';return e+="'...'",e+='}"><a href="" ng-click="setCurrent(pageNumber)">{{ pageNumber }}</a></li><li ng-if="directionLinks" ng-class="{ disabled : pagination.current == pagination.last }"><a href="" ng-click="setCurrent(pagination.current + 1)">&rsaquo;</a></li><li ng-if="boundaryLinks"  ng-class="{ disabled : pagination.current == pagination.last }"><a href="" ng-click="setCurrent(pagination.last)">&raquo;</a></li></ul>'},scope:{maxSize:"=?",onpagechange:"&?",paginationId:"=?",module:"@"},link:function(a,r,s){function o(n){if(u(n))if(a.pages=t(n,e.getCollectionLength(p),e.getItemsPerPage(p),f),a.pagination.current=n,c(),a.module){var i=a.module;try{a.$parent.$resoure[i+"QueryData"].call(this,{pagination:{page:n,rows:e.getItemsPerPage(p)}})}catch(r){console.log(r)}}else a.onpagechange&&a.onpagechange({page:n,rows:e.getItemsPerPage(p)})}function g(){var n=parseInt(e.getCurrentPage(p))||1;a.pages=t(n,e.getCollectionLength(p),e.getItemsPerPage(p),f),a.pagination.current=n,a.pagination.last=a.pages[a.pages.length-1],a.pagination.last<a.pagination.current?a.setCurrent(a.pagination.last):c()}function c(){var t=e.getCurrentPage(p),n=e.getItemsPerPage(p),i=e.getCollectionLength(p);a.range.lower=(t-1)*n+1,a.range.upper=Math.min(t*n,i),a.range.total=i}function u(e){return i.test(e)&&e>0&&e<=a.pagination.last}var l=s.paginationId||n,p=a.paginationId||s.paginationId||n;if(!e.isRegistered(p)&&!e.isRegistered(l)){var d=p!==n?" (id: "+p+") ":" ";throw"pagination directive: the pagination controls"+d+"cannot be used without the corresponding pagination directive."}a.maxSize||(a.maxSize=9),a.directionLinks=angular.isDefined(s.directionLinks)?a.$parent.$eval(s.directionLinks):!0,a.boundaryLinks=angular.isDefined(s.boundaryLinks)?a.$parent.$eval(s.boundaryLinks):!1;var f=Math.max(a.maxSize,5);a.pages=[],a.pagination={last:1,current:1},a.range={lower:1,upper:1,total:1},a.$watch(function(){return(e.getCollectionLength(p)+1)*e.getItemsPerPage(p)},function(e){e>0&&g()}),a.$watch(function(){return e.getItemsPerPage(p)},function(e,t){e!=t&&o(a.pagination.current)}),a.$watch(function(){return e.getCurrentPage(p)},function(e,t){e!=t&&o(e)}),a.setCurrent=function(t){u(t)&&e.setCurrentPage(p,t)}}}}]),e.filter("itemsPerPage",["paginationService",function(e){return function(t,a,i){if("undefined"==typeof i&&(i=n),!e.isRegistered(i))throw"pagination directive: the itemsPerPage id argument (id: "+i+") does not match a registered pagination-id.";var r,s;return t instanceof Array?(a=parseInt(a)||9999999999,s=e.isAsyncMode(i)?0:(e.getCurrentPage(i)-1)*a,r=s+a,e.setItemsPerPage(i,a),t.slice(s,r)):t}}]),e.service("paginationService",function(){var e,t={};this.registerInstance=function(n){"undefined"==typeof t[n]&&(t[n]={asyncMode:!1},e=n)},this.isRegistered=function(e){return"undefined"!=typeof t[e]},this.getLastInstanceId=function(){return e},this.setCurrentPageParser=function(e,n,a){t[e].currentPageParser=n,t[e].context=a},this.setCurrentPage=function(e,n){t[e].currentPageParser.assign(t[e].context,n)},this.getCurrentPage=function(e){var n=t[e].currentPageParser;return n?n(t[e].context):1},this.setItemsPerPage=function(e,n){t[e].itemsPerPage=n},this.getItemsPerPage=function(e){return t[e].itemsPerPage||10},this.setCollectionLength=function(e,n){t[e].collectionLength=n},this.getCollectionLength=function(e){return t[e].collectionLength},this.setAsyncModeTrue=function(e){t[e].asyncMode=!0},this.isAsyncMode=function(e){return t[e].asyncMode}}),e.provider("paginationTemplate",function(){var e="./templates/phoebe.lib.pagination.tpl.html";this.setPath=function(t){e=t},this.$get=function(){return{getPath:function(){return e}}}})}();
//# sourceMappingURL=phoebe.library.min.js.map